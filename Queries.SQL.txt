- SQL SALES ANALYSIS PROJECT
-- Author: Akshat Mandhaniya
-- Description: Sales and customer analysis using SQL

- 1. View all customers
Description: Displays all customer records to understand the customer dataset.
SELECT * FROM customers;

-- 2. View all products
Description: Lists all products with details such as category and price.
SELECT * FROM products;

-- 3. View all orders
Description: Displays all orders placed, including customer and product IDs.
SELECT * FROM orders;

-- 4. List customers from Delhi
Description: Filters customers based on city to analyze regional data.
SELECT *
FROM customers
WHERE city = 'Delhi';

-- 5. List products priced above 5000
Description: Filters high-value products to focus on premium sales.
SELECT *
FROM products
WHERE price > 5000;

-- 6. Show all orders with customer names
Description: Combines orders with customer names to see who placed which order.
SELECT o.order_id, c.customer_name, o.order_date
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id;

-- 7. Show all orders with product names
Description: Combines orders with product names to identify which products were ordered.
SELECT o.order_id, p.product_name, o.quantity
FROM orders o
JOIN products p ON o.product_id = p.product_id;

-- 8. Show customer name, product name, and order date
Description: Joins orders, customers, and products to get full order details.
SELECT c.customer_name, p.product_name, o.order_date
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN products p ON o.product_id = p.product_id;

-- 9. Show total quantity ordered per product
Description: Aggregates total quantity per product to identify top-selling items.
SELECT p.product_name, SUM(o.quantity) AS total_quantity
FROM orders o
JOIN products p ON o.product_id = p.product_id
GROUP BY p.product_name;

-- 10. Show total orders placed by each customer
Description: Counts how many orders each customer placed to understand customer activity.
SELECT c.customer_name, COUNT(o.order_id) AS total_orders
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
GROUP BY c.customer_name;

11. Calculate total revenue per product
Description: Computes total revenue generated by each product.
SELECT p.product_name,
       SUM(o.quantity * p.price) AS total_revenue
FROM orders o
JOIN products p ON o.product_id = p.product_id
GROUP BY p.product_name;

-- 12. Calculate total revenue per customer
description: Calculates total spending per customer to identify top customers.
SELECT c.customer_name,
       SUM(o.quantity * p.price) AS total_spent
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN products p ON o.product_id = p.product_id
GROUP BY c.customer_name;

-- 13. Find the most expensive product
Description: Identifies the product with the highest price.
SELECT product_name, price
FROM products
ORDER BY price DESC
LIMIT 1;

-- 14. Find average product price by category
Description: Computes the average price of products in each category for pricing analysis.
SELECT category, AVG(price) AS avg_price
FROM products
GROUP BY category;

-- 15. Find customers who placed more than 2 orders
Description: Identifies repeat customers to analyze purchasing behavior.
SELECT c.customer_name, COUNT(o.order_id) AS order_count
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
GROUP BY c.customer_name
HAVING COUNT(o.order_id) > 2;

16. Find products with price higher than average price
Description: Lists products priced above the average, highlighting premium items.
SELECT product_name, price
FROM products
WHERE price > (SELECT AVG(price) FROM products);

-- 17. Find customers who ordered a Laptop
Description: Identifies all customers who purchased a specific product (Laptop).
SELECT DISTINCT c.customer_name
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN products p ON o.product_id = p.product_id
WHERE p.product_name = 'Laptop';

-- 18. Rank products based on total revenue
Description: Assigns a rank to each product based on total revenue generated.
SELECT product_name,
       total_revenue,
       RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM (
    SELECT p.product_name,
           SUM(o.quantity * p.price) AS total_revenue
    FROM orders o
    JOIN products p ON o.product_id = p.product_id
    GROUP BY p.product_name
) t;

-- 19. Find monthly order count
Description: Counts the number of orders placed each month to analyze trends over time.
SELECT MONTH(order_date) AS order_month,
       COUNT(order_id) AS total_orders
FROM orders
GROUP BY MONTH(order_date)
ORDER BY order_month;

-- 20. Find top 3 customers by total spending
Description: Lists the top 3 customers based on total spending for targeted analysis.
SELECT customer_name, total_spent
FROM (
    SELECT c.customer_name,
           SUM(o.quantity * p.price) AS total_spent
    FROM orders o
    JOIN customers c ON o.customer_id = c.customer_id
    JOIN products p ON o.product_id = p.product_id
    GROUP BY c.customer_name) t
ORDER BY total_spent DESC
LIMIT 3;